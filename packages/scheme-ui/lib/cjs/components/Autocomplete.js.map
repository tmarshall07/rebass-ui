{"version":3,"sources":["../../../src/components/Autocomplete.tsx"],"names":["updateScroll","el","index","parent","children","child","childOffsetTop","offsetTop","parentScrollTop","scrollTop","parentHeight","offsetHeight","childHeight","scrollToY","scrollTo","Autocomplete","props","value","placeholder","items","menuProps","inputProps","onChange","onSelect","keyExtractor","renderItem","menuRef","menuVisible","setMenuVisible","focusedIndex","setFocusedIndex","current","containerRef","handleSelect","item","handleFocus","e","onFocus","handleKeyDown","newFocusedIndex","key","preventDefault","length","position","bg","maxHeight","width","overflow","zIndex","marginTop","borderRadius","boxShadow","borderStyle","borderColor","borderWidth","sx","map","i"],"mappings":"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","sourcesContent":["import { InputProps } from '@rebass/forms';\nimport React, { ChangeEvent, KeyboardEvent, ReactChild, useEffect, useRef, useState } from 'react';\nimport useClickOutside from '../hooks/useClickOutside';\nimport Box, { BoxProps } from './Box';\nimport Input from './Input';\n\nexport type Item = { [index: string]: any };\n\nexport type AutocompleteProps = {\n  value: string;\n  items?: Item[];\n  placeholder?: string;\n  menuProps?: BoxProps;\n  inputProps?: InputProps;\n  keyExtractor: (item: Item) => string | number;\n  renderItem: (item: Item, hasFocus: boolean) => ReactChild;\n  onChange?: (e: ChangeEvent) => void;\n  onSelect?: (item: Item) => void;\n};\n\n/**\n * Update the scroll to show more items as the user arrows up or down\n *\n * @param {HTMLElement} el\n * @param {number} index\n */\nconst updateScroll = (el: HTMLElement, index: number): void => {\n  const parent = el;\n  if (parent?.children) {\n    const child = parent.children[index] as HTMLElement;\n    if (child) {\n      const childOffsetTop = child.offsetTop;\n      const parentScrollTop = parent.scrollTop;\n      const parentHeight = parent.offsetHeight;\n      const childHeight = child.offsetHeight;\n\n      if (childOffsetTop + childHeight > parentHeight + parentScrollTop) {\n        const scrollToY = childOffsetTop + childHeight - parentHeight;\n        parent.scrollTo(0, scrollToY);\n      } else if (childOffsetTop < parentScrollTop) {\n        parent.scrollTo(0, childOffsetTop);\n      }\n    }\n  }\n};\n\nconst Autocomplete = (props: AutocompleteProps): JSX.Element => {\n  const {\n    value,\n    placeholder,\n    items = [],\n    menuProps = {},\n    inputProps = {},\n    onChange,\n    onSelect,\n    keyExtractor,\n    renderItem,\n  } = props;\n\n  const menuRef = useRef<HTMLElement>();\n\n  const [menuVisible, setMenuVisible] = useState(false);\n  const [focusedIndex, setFocusedIndex] = useState(0);\n\n  // Handle using arrows to scroll up and down\n  useEffect(() => {\n    updateScroll(menuRef.current, focusedIndex);\n  }, [focusedIndex]);\n\n  const containerRef = useRef();\n\n  useClickOutside(containerRef, () => setMenuVisible(false));\n\n  const handleSelect = (item): void => {\n    setMenuVisible(false);\n    onSelect(item);\n  };\n\n  const handleFocus = (e): void => {\n    setMenuVisible(true);\n    inputProps.onFocus?.(e);\n  };\n\n  const handleKeyDown = (e: KeyboardEvent): void => {\n    let newFocusedIndex = focusedIndex;\n    switch (e.key) {\n      case 'ArrowUp': // Up\n        e.preventDefault();\n        if (!(focusedIndex - 1 < 0)) newFocusedIndex -= 1;\n        break;\n      case 'ArrowDown': // Down\n        e.preventDefault();\n        if (!(focusedIndex + 1 >= items.length)) newFocusedIndex += 1;\n        break;\n      case 'Enter': // Enter\n        e.preventDefault();\n        handleSelect(items[focusedIndex]);\n        break;\n      default:\n        break;\n    }\n\n    setFocusedIndex(newFocusedIndex);\n  };\n\n  return (\n    <Box sx={{ position: 'relative' }} ref={containerRef}>\n      <Input\n        placeholder={placeholder}\n        value={value}\n        onChange={onChange}\n        onFocus={handleFocus}\n        onKeyDown={handleKeyDown}\n        {...inputProps}\n      />\n      {menuVisible && !!items.length && (\n        <Box\n          ref={menuRef}\n          {...menuProps}\n          sx={{\n            position: 'absolute',\n            bg: 'bg-2',\n            maxHeight: 300,\n            width: '100%',\n            overflow: 'auto',\n            zIndex: 2,\n            marginTop: 1,\n            borderRadius: 5,\n            boxShadow: 'large',\n            borderStyle: 'solid',\n            borderColor: 'gray5',\n            borderWidth: 1,\n            ...(menuProps?.sx || {}),\n          }}\n        >\n          {items.map((item, i) => (\n            <Box onClick={() => handleSelect(item)} key={keyExtractor(item)}>\n              {renderItem(item, i === focusedIndex)}\n            </Box>\n          ))}\n        </Box>\n      )}\n    </Box>\n  );\n};\n\nexport default Autocomplete;\n"],"file":"Autocomplete.js"}